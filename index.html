<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<div id="container">
			<input type="file" name="inputfile" id="inputfile" accept="JSON" />
			<br />

			<pre id="output"></pre>
		</div>

		<script type="text/javascript">
			let outputText = [];
			document
				.getElementById("inputfile")
				.addEventListener("change", function () {
					const fr = new FileReader();
					fr.onload = function () {
						const transactionInfo = JSON.parse(fr.result);

						const aportantes = transactionInfo.aportantes;
						aportantes.forEach((aportanteInfo) => {
							const pagos = aportanteInfo.resultado_pagos;
							pagos.forEach((pagosInfo) => {
								outputText.push({
                  numero_identificacion_persona_natural:transactionInfo.numero_identificacion_persona_natural,
									consulta_id: transactionInfo.consulta_id,
                  primer_nombre_persona_natural:transactionInfo.primer_nombre_persona_natural,

                  media_ingresos:aportanteInfo.media_ingresos,
                  tipo_identificacion_aportante_id:aportanteInfo.tipo_identificacion_aportante_id,
                  numero_identificacion_aportante:aportanteInfo.numero_identificacion_aportante,
                  razón_social_aportante:aportanteInfo.razón_social_aportante,
                  
									prediodo_cotizacion:pagosInfo.ano_periodo_validado+"-"+pagosInfo.mes_periodo_validado,

								}) ;
							});
						});

						var data =
							"text/json;charset=utf-8," +
							encodeURIComponent(JSON.stringify(outputText));

						var a = document.createElement("a");
						a.href = "data:" + data;
						a.download = "data.json";
						a.innerHTML = "download JSON";

						var container = document.getElementById("container");
						container.appendChild(a);

						document.getElementById("output").innerText =
							JSON.stringify(outputText);
					};
					fr.readAsText(this.files[0]);
				});
		</script>
	</body>
</html>
